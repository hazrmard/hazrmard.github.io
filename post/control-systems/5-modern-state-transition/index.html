<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=keywords content="matlab,control systems,engineering"><meta name=description content="The state equation for a linear time-invariant system:
$$ x'(t) = A x(t) + B u(t) $$
Can be solved for $x(t)$. We collect all terms in $x$:
$$ x'(t) - A x(t) = B u(t) $$
Multiply equation by $e^{-At}$
$$ x'(t) e^{-At} - A x(t) e^{-At} = B u(t) e^{-At} $$
Using product rule $d(f;g) = f;dg + g;df$, where:
$$\begin{align*}df = - A e^{-At} \rightarrow & f = e^{-At} \\dg = x&#39;(t) \rightarrow & g = x(t) \\\\\therefore x&#39;(t) e^{-At} - A x(t) e^{-At} &= d (e^{-At} x(t))\end{align*}$$To give:"><link rel=stylesheet type=text/css href=/css/hugolb.css><link rel=stylesheet type=text/css href=/css/cosmetic.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-118761164-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-118761164-1')</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css integrity=sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js integrity=sha384-YNHdsYkH6gMx9y3mRkmcJ2mFUjTd0qNQQvY9VYZgQd7DcN7env35GzlmFaZ23JGp crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:!0},{left:'$',right:'$',display:!1}]})"></script><title>Ibrahim Ahmed: Modern control: Solutions & state transition matrices</title></head><body><div class=container><article class=content><h1 class=post-title>Modern control: Solutions & state transition matrices</h1><div class=front-matter><em>Monday, Sep 24, 2018</em><br>Section:
<a href=/>Home</a>
/ <a href=/post>Post</a>
/ <a href=/post/control-systems>Control systems</a><br>Categories:
<a href=/categories/engineering>Engineering</a>,<br>Tags:
<a href=/tags/matlab>Matlab</a>,
<a href=/tags/control-systems>Control Systems</a>,</div><p>The state equation for a linear time-invariant system:</p><p>$$
x'(t) = A x(t) + B u(t)
$$</p><p>Can be solved for $x(t)$. We collect all terms in $x$:</p><p>$$
x'(t) - A x(t) = B u(t)
$$</p><p>Multiply equation by $e^{-At}$</p><p>$$
x'(t) e^{-At} - A x(t) e^{-At} = B u(t) e^{-At}
$$</p><p>Using product rule $d(f;g) = f;dg + g;df$, where:</p><div>$$
\begin{align*}
df = - A e^{-At} \rightarrow & f = e^{-At}    \\
dg = x'(t)    \rightarrow & g = x(t)  \\
\\
\therefore x'(t) e^{-At} - A x(t) e^{-At} &= d (e^{-At} x(t))
\end{align*}
$$</div><p>To give:</p><p>$$
\frac{d}{dt} (e^{-At} x(t)) = B u(t) e^{-At}
$$</p><p>Which can be integrated on the limits $t = t_0 \rightarrow t$:</p><div>$$
\begin{align*}
e^{-At} x(t) \rvert_{t_0}^{t} &= B \int_{t_0}^{t} u(t) e^{-At} \; dt \\
e^{-At} x(t) &= e^{-At_0} x(t_0) + B \int_{t_0}^{t} u(t) e^{-At} \; dt
\end{align*}
$$</div><p>The solution to the state equation is:</p><div class=outlined style=width:100%><div>$$
x(t) = e^{A(t-t_0)} x(t_0) + B e^{At} \int_{t_0}^{t} u(t) e^{-At} \; dt
$$</div></div><p>This can be plugged into the output equation to compute system outputs.</p><h2 id=state-transition-matrix>State transition matrix</h2><p>The term $e^{At}$ is called the state transition matrix. It is an exponental of the system matrix which relates the change in state to the current state. The exponential can be calculated in several ways through Taylor series expansion an inverse laplace transform, spectral decomposition, or the Cayley-Hamilton theorem.</p><p>In MatLab:</p><div class=highlight><div style=color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=color:#268bd2>A</span> = [<span style=color:#2aa198;font-weight:700>1</span> <span style=color:#2aa198;font-weight:700>2</span>; <span style=color:#2aa198;font-weight:700>3</span> <span style=color:#2aa198;font-weight:700>4</span>]      <span style=color:#93a1a1;font-style:italic>% A is some matrix</span>
<span style=color:#268bd2>t</span> = <span style=color:#268bd2>sym</span>(<span style=color:#2aa198>&#39;t&#39;</span>)        <span style=color:#93a1a1;font-style:italic>% create symbol</span>
<span style=color:#268bd2>eAt</span> = <span style=color:#268bd2>expm</span>(<span style=color:#268bd2>A</span> * <span style=color:#268bd2>t</span>)   <span style=color:#93a1a1;font-style:italic>% compute exponential</span>
</code></pre></td></tr></table></div></div><p>For the case of time-varying systems, the state transition matrix is not a simple exponential but a function $\phi(t, t_0)$ unique to the system. The general solution of the state equation for time-varying systems becomes:</p><div>$$
x(t) = \phi(t, t_0) x(t_0) + \int_{t_0}^{t} \phi(t, t_0) B(t) u(t) \; dt
$$</div><p>More details on the general solution can be found in the <a href=https://en.wikibooks.org/wiki/Control_Systems/Time_Variant_System_Solutions>WikiBook</a>.</p><h2 id=example---spring-mass-system>Example - spring mass system</h2><p>Using the matrices found in the <a href=https://iahmed.me/post/control-systems/4-modern-state-space-equations/>last post</a>, we have the state space matrices:</p><div>$$
A =
\begin{bmatrix}
0 &   1       \\
    \frac{-k}{m} & \frac{-a}{m}
\end{bmatrix},
B =
\begin{bmatrix}
0 \\
\frac{1}{m}
\end{bmatrix},
C =
\begin{bmatrix}
1 &   0
\end{bmatrix},
D = 
\begin{bmatrix}
0
\end{bmatrix}
$$</div><p>Making some assumptions for the constants, we can define the matrices in MatLab:</p><div class=highlight><div style=color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=color:#268bd2>m</span> = <span style=color:#2aa198;font-weight:700>10</span>;                 <span style=color:#93a1a1;font-style:italic>% setting constants</span>
<span style=color:#268bd2>k</span> = <span style=color:#2aa198;font-weight:700>2</span>;
<span style=color:#268bd2>a</span> = <span style=color:#2aa198;font-weight:700>3</span>;

<span style=color:#268bd2>A</span> = [<span style=color:#2aa198;font-weight:700>0</span> <span style=color:#2aa198;font-weight:700>1</span>; -<span style=color:#268bd2>k</span>/<span style=color:#268bd2>m</span> -<span style=color:#268bd2>a</span>/<span style=color:#268bd2>m</span>];   <span style=color:#93a1a1;font-style:italic>% defining state-space matrices</span>
<span style=color:#268bd2>B</span> = [<span style=color:#2aa198;font-weight:700>0</span>; <span style=color:#2aa198;font-weight:700>1</span>/<span style=color:#268bd2>m</span>];
<span style=color:#268bd2>C</span> = [<span style=color:#2aa198;font-weight:700>1</span> <span style=color:#2aa198;font-weight:700>0</span>];
<span style=color:#268bd2>D</span> = [<span style=color:#2aa198;font-weight:700>0</span>];

<span style=color:#268bd2>sys</span> = <span style=color:#268bd2>ss</span>(<span style=color:#268bd2>A</span>, <span style=color:#268bd2>B</span>, <span style=color:#268bd2>C</span>, <span style=color:#268bd2>D</span>);   <span style=color:#93a1a1;font-style:italic>% defining the system</span>
</code></pre></td></tr></table></div></div><h3 id=impulse-response>Impulse response</h3><p>Using the matlab command, we get:</p><div class=highlight><div style=color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=color:#268bd2>impulseplot</span>(<span style=color:#268bd2>sys</span>, <span style=color:#2aa198;font-weight:700>10</span>)
</code></pre></td></tr></table></div></div><figure><img src=/img/posts/ai-methods-for-control-systems/5-spring-impulse.png></figure><h3 id=impulse-response-1>Impulse response</h3><p>Using the matlab command, we get:</p><div class=highlight><div style=color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=color:#268bd2>stepplot</span>(<span style=color:#268bd2>sys</span>, <span style=color:#2aa198;font-weight:700>10</span>)
</code></pre></td></tr></table></div></div><figure><img src=/img/posts/ai-methods-for-control-systems/5-spring-step.png></figure><br><div class=navigation><a href=https://iahmed.me/post/control-systems/4-modern-state-space-equations/><div class="prev nav-item">← Previous Post</div></a></div><br></article><div class=sidebar><div class=menu-icon><h2>≡</h2></div><div class=title><h1 class=site-name>Ibrahim Ahmed</h1><div class=sb-links><a href=https://www.linkedin.com/in/IbrahimAhmed1><img src=/img/LinkIcons/svg/linkedin.svg></a>
<a href=https://github.com/hazrmard><img src=/img/LinkIcons/svg/github.svg></a>
<a href="https://scholar.google.com/citations?user=_Nn9bWgAAAAJ&hl=en"><img src=/img/LinkIcons/svg/google-scholar.svg></a>
<a href=http://stackoverflow.com/users/4591810/hazrmard><img src=/img/LinkIcons/svg/stackoverflow.svg></a></div></div><ul class=menu-list><a href=/><li class=sb-option><img src=/img/LinkIcons/svg/home.svg alt=Home><span class=menu-option-name>Home</span></li></a><a href=/about/><li class=sb-option><img src=/img/LinkIcons/svg/person.svg alt="About Me"><span class=menu-option-name>About Me</span></li></a><a href=/resume/><li class=sb-option><img src=/img/LinkIcons/svg/document.svg alt=Résumé><span class=menu-option-name>Résumé</span></li></a><a href=#noexist><li class="sb-option dropdown"><img src=/img/LinkIcons/svg/pencil.svg alt=Posts><span class=menu-option-name>Posts</span><div class=submenu><ul><a href=/categories><li>By Categories</li></a><a href=/tags><li>By Tags</li></a><a href=/post><li>All</li></a></ul></div></li></a><a href=/project/><li class=sb-option><img src=/img/LinkIcons/svg/terminal.svg alt=Projects><span class=menu-option-name>Projects</span></li></a></ul></div><div class=footer><div class=copyright>© Ibrahim Ahmed</div></div></div></body></html>